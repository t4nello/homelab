services:
  stirlingpdf:
    container_name: stirlingpdf
    image: stirlingtools/stirling-pdf:latest-fat
    networks:
      - applications
    labels:
      - "logaggregation=yes"
      - "traefik.enable=true"
      - "traefik.http.routers.stirlingpdf.rule=Host(`stirling.${HOST}`)"
      - "traefik.http.services.stirlingpdf.loadbalancer.server.port=8080"
      - "traefik.docker.network=applications"
    environment:
      - DISABLE_ADDITIONAL_FEATURES=false
      - DOCKER_ENABLE_SECURITY=false
      - SYSTEM_DEFAULTLOCALE=${LOCALE:-pl-PL}
      - SYSTEM_MAXFILESIZE=100
      - METRICS_ENABLED=true
    volumes:
      - stirling_data:/configs
    restart: unless-stopped
    healthcheck:
      test: ["CMD-SHELL", "curl -f http://localhost:8080/api/v1/info/status || curl -f http://localhost:8080/ || exit 1"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 60s

volumes:
  stirling_data:
    name: stirling_data

networks:
  applications:
    external: true